<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.613a3714fa9d85827a3b.css" id="gatsby-global-css">code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style><meta name="generator" content="Gatsby 2.32.13"/><style data-styled="" data-styled-version="5.3.5">.cWgxjN{top:0;left:0;margin:0 auto;display:block;width:100%;z-index:1000;background-color:rgba(32,35,42,0.85);font-weight:700;}/*!sc*/
@media (min-width:700px){.cWgxjN{position:fixed;}}/*!sc*/
data-styled.g1[id="Header__HeaderWrapper-sc-1glvhxp-0"]{content:"cWgxjN,"}/*!sc*/
.gMIjKp{font-weight:700;margin-left:auto;margin-right:auto;height:60px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;max-width:770px;z-index:1000;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;overflow-x:auto;overflow-y:hidden;white-space:nowrap;padding:0px 20px;}/*!sc*/
data-styled.g2[id="Header__HeaderNav-sc-1glvhxp-1"]{content:"gMIjKp,"}/*!sc*/
.ZwWsM{display:none;-webkit-box-align:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
@media (min-width:700px){.ZwWsM{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}/*!sc*/
data-styled.g3[id="Header__HeaderLinksContainer-sc-1glvhxp-2"]{content:"ZwWsM,"}/*!sc*/
.ktAEsK{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:#ffffff;border:0;margin:0;padding:8px 10px;min-width:42px;z-index:10;}/*!sc*/
.Header__HeaderLink-sc-1glvhxp-3 + .Header__HeaderLink-sc-1glvhxp-3{margin-left:0.7rem;}/*!sc*/
data-styled.g4[id="Header__HeaderLink-sc-1glvhxp-3"]{content:"ktAEsK,"}/*!sc*/
.cVdlXH{padding-left:0;}/*!sc*/
data-styled.g5[id="Header__HeaderLinkTitle-sc-1glvhxp-4"]{content:"cVdlXH,"}/*!sc*/
.dkTieV{display:block;padding-left:0;}/*!sc*/
data-styled.g6[id="Header__HeaderLinkTitleContent-sc-1glvhxp-5"]{content:"dkTieV,"}/*!sc*/
.dyFkfb{z-index:30;top:0px;position:relative;color:#ffffff;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;background:transparent;border:none;cursor:pointer;padding:8px 12px;outline:none;-webkit-tap-highlight-color:transparent;}/*!sc*/
@media (min-width:700px){.dyFkfb{display:none;}}/*!sc*/
data-styled.g10[id="Header__BurgerButton-sc-1glvhxp-9"]{content:"dyFkfb,"}/*!sc*/
.ieJuJZ{width:24px;height:2px;background:#ffffff;position:absolute;left:0;background:#ffffff;-webkit-transition:all 250ms cubic-bezier(0.86,0,0.07,1);transition:all 250ms cubic-bezier(0.86,0,0.07,1);}/*!sc*/
.ieJuJZ::before{content:'';top:-8px;width:24px;height:2px;background:#ffffff;position:absolute;left:0;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);-webkit-transition:all 250ms cubic-bezier(0.86,0,0.07,1);transition:all 250ms cubic-bezier(0.86,0,0.07,1);}/*!sc*/
.ieJuJZ::after{top:8px;content:'';width:24px;height:2px;background:white;position:absolute;left:0;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);-webkit-transition:all 250ms cubic-bezier(0.86,0,0.07,1);transition:all 250ms cubic-bezier(0.86,0,0.07,1);}/*!sc*/
data-styled.g11[id="Header__BurgerContent-sc-1glvhxp-10"]{content:"ieJuJZ,"}/*!sc*/
.blEBCc{text-align:left;padding-top:30px;padding-bottom:50px;background-color:#3E4047;color:#ffffff;padding-left:20px;padding-right:20px;margin:0 auto;}/*!sc*/
.blEBCc nav{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:row wrap;-ms-flex-flow:row wrap;flex-flow:row wrap;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;max-width:900px;margin:0 auto;}/*!sc*/
.blEBCc nav .footer-col{-webkit-flex:1 auto;-ms-flex:1 auto;flex:1 auto;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin-bottom:1em;padding-right:1em;}/*!sc*/
.blEBCc a{color:#ffffff;font-weight:bold;}/*!sc*/
.blEBCc a:hover{color:#CFCFD1;}/*!sc*/
.blEBCc .footer-col > p{margin:0;}/*!sc*/
.blEBCc .footer-title{margin:0 0 1rem;}/*!sc*/
.blEBCc .footer-item{padding:0.25rem 0;color:#ffffff;}/*!sc*/
.blEBCc .footer-heart{color:red;}/*!sc*/
.blEBCc .footer-item-text{padding:0.1rem 0;color:#ffffff;}/*!sc*/
.blEBCc .footer-header{-webkit-order:1;-ms-flex-order:1;order:1;margin:0 0.25rem;margin-right:0.25rem;padding:0.25rem;}/*!sc*/
@media (max-width:564px){.blEBCc .footer-col:first-child{width:100%;}}/*!sc*/
data-styled.g12[id="Footer__FooterWrapper-sc-t92llg-0"]{content:"blEBCc,"}/*!sc*/
*{box-sizing:border-box;margin:0;padding:0;}/*!sc*/
body{font-family:"Lato",sans-serif;color:#3E4047;background-color:#f4f8fb;}/*!sc*/
img{max-width:100%;height:auto;vertical-align:middle;border:0;}/*!sc*/
a{-webkit-text-decoration:none;text-decoration:none;color:#3E4047;}/*!sc*/
hr{border:0;border-top:1px solid #ECECED;margin:50px 0 5px 0;}/*!sc*/
ul,ol{padding-left:2em;margin:1em 0 0 0;}/*!sc*/
*::selection{background-color:#ffdc4e;}/*!sc*/
data-styled.g13[id="sc-global-bWaZNT1"]{content:"sc-global-bWaZNT1,"}/*!sc*/
.cOcOiw{line-height:1.6;margin:1em 0 0 0;}/*!sc*/
data-styled.g15[id="Commons__Text-sc-1aaxjtz-1"]{content:"cOcOiw,"}/*!sc*/
.kryMlH{display:inline-block;color:#697980;margin:0 4px;}/*!sc*/
.kryMlH::before{content:'•';}/*!sc*/
data-styled.g16[id="Commons__Bull-sc-1aaxjtz-2"]{content:"kryMlH,"}/*!sc*/
.iyWqdd{margin:0 0;}/*!sc*/
@media (min-width:700px){.iyWqdd{margin:60px 0;}}/*!sc*/
data-styled.g17[id="layout__SiteContent-sc-nrr2ov-0"]{content:"iyWqdd,"}/*!sc*/
.ldnCoM{position:relative;border-radius:5px;width:80%;max-width:770px;word-wrap:break-word;background-color:#ffffff;margin:0px auto 30px auto;top:30px;padding:50px;box-shadow:0 0 0 0,0 6px 12px rgba(0,0,0,0.1);}/*!sc*/
@media (max-width:780px){.ldnCoM{width:100%;padding:25px;}}/*!sc*/
data-styled.g18[id="Wrapper-sc-xmiwfw-0"]{content:"ldnCoM,"}/*!sc*/
.PGRvC{position:relative;display:table;width:100%;height:400px;overflow:hidden;background-repeat:no-repeat;background-position:center;background-size:cover;}/*!sc*/
data-styled.g23[id="Hero__HeroContainer-sc-1wsaguq-0"]{content:"PGRvC,"}/*!sc*/
.cWvcOU{display:table-cell;vertical-align:middle;text-align:center;width:100%;}/*!sc*/
data-styled.g24[id="Hero__TitleContainer-sc-1wsaguq-1"]{content:"cWvcOU,"}/*!sc*/
.izqjLH{font-weight:700;font-size:3rem;margin:10px 50px;color:#ffffff;text-shadow:1px 1px 4px rgba(34,34,34,0.85);}/*!sc*/
data-styled.g25[id="Hero__HeroTitle-sc-1wsaguq-2"]{content:"izqjLH,"}/*!sc*/
.hWQjmQ{display:inline;color:#697980;}/*!sc*/
data-styled.g27[id="TagList__ListContainer-sc-tgjq80-0"]{content:"hWQjmQ,"}/*!sc*/
.fYuXeX{text-transform:uppercase;color:#697980;}/*!sc*/
.fYuXeX:not(:first-child){margin-left:0.3rem;}/*!sc*/
.fYuXeX:hover{border-bottom:1px dotted #57595d;}/*!sc*/
.fYuXeX:before{content:'#';}/*!sc*/
data-styled.g28[id="TagList__TagListItemLink-sc-tgjq80-1"]{content:"fYuXeX,"}/*!sc*/
.iIVHxY{text-transform:uppercase;color:#697980;}/*!sc*/
.iIVHxY:not(:first-child){margin-left:0.3rem;}/*!sc*/
.iIVHxY:before{content:'#';}/*!sc*/
data-styled.g29[id="TagList__TagListItem-sc-tgjq80-2"]{content:"iIVHxY,"}/*!sc*/
.iUHlwx .author-image{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;position:absolute;top:-40px;left:50%;margin-left:-40px;width:80px;height:80px;border-radius:100%;overflow:hidden;padding:6px;z-index:2;box-shadow:#ececec 0 0 0 1px;background-color:#ffffff;}/*!sc*/
.iUHlwx .author-image .img{position:relative;display:block;width:100%;height:100%;background-size:cover;background-position:center center;border-radius:100%;}/*!sc*/
.iUHlwx .author-profile .author-image{position:relative;left:auto;top:auto;width:120px;height:120px;padding:3px;margin:-100px auto 0 auto;box-shadow:none;}/*!sc*/
data-styled.g42[id="Bio__BioWrapper-sc-d7fgaq-0"]{content:"iUHlwx,"}/*!sc*/
.bDffwm a{box-shadow:0 2px 0 0 #ffdc4e;}/*!sc*/
.bDffwm a:hover{-webkit-filter:brightness(150%);filter:brightness(150%);box-shadow:none;}/*!sc*/
data-styled.g43[id="Bio__BioText-sc-d7fgaq-1"]{content:"bDffwm,"}/*!sc*/
.dqNEvl{margin-bottom:2rem;color:#57595d;font-size:0.9em;}/*!sc*/
data-styled.g47[id="ContentHeader__Header-sc-1qtxhip-0"]{content:"dqNEvl,"}/*!sc*/
.iyafxb{line-height:1.6;}/*!sc*/
.iyafxb > h2{padding-top:3rem;margin-top:3rem;border-top:1px solid #ececec;}/*!sc*/
.iyafxb > h3{padding-top:3rem;}/*!sc*/
.iyafxb > p{margin:1em 0 0 0;}/*!sc*/
.iyafxb a{box-shadow:0 2px 0 0 #ffdc4e;}/*!sc*/
.iyafxb a:hover{-webkit-filter:brightness(150%);filter:brightness(150%);box-shadow:none;}/*!sc*/
.iyafxb a.anchor,.iyafxb a.gatsby-resp-image-link{box-shadow:none;}/*!sc*/
.iyafxb h1 .anchor svg,.iyafxb h2 .anchor svg,.iyafxb h3 .anchor svg,.iyafxb h4 .anchor svg,.iyafxb h5 .anchor svg,.iyafxb h6 .anchor svg{visibility:hidden;margin-left:-16px;}/*!sc*/
.iyafxb h1:hover .anchor svg,.iyafxb h2:hover .anchor svg,.iyafxb h3:hover .anchor svg,.iyafxb h4:hover .anchor svg,.iyafxb h5:hover .anchor svg,.iyafxb h6:hover .anchor svg,.iyafxb h1 .anchor:focus svg,.iyafxb h2 .anchor:focus svg,.iyafxb h3 .anchor:focus svg,.iyafxb h4 .anchor:focus svg,.iyafxb h5 .anchor:focus svg,.iyafxb h6 .anchor:focus svg{visibility:visible;}/*!sc*/
.iyafxb > blockquote{box-sizing:border-box;background-color:#f7f7f7;border-left:5px solid rgb(244,213,36);margin:30px 0px;padding:5px 20px;border-radius:0 8px 8px 0;}/*!sc*/
.iyafxb > blockquote p{margin:0.8em 0;font-style:italic;}/*!sc*/
.iyafxb .gatsby-highlight{border-radius:5px;font-size:15px;line-height:1.7;border-radius:10px;overflow:auto;tab-size:1.5em;margin:1.5em -1.5em;}/*!sc*/
@media (max-width:500px){.iyafxb .gatsby-highlight{border-radius:0;margin-left:-25px;margin-right:-25px;}}/*!sc*/
.iyafxb .gatsby-highlight > pre{border:0;margin:0;padding:1;}/*!sc*/
.iyafxb .gatsby-highlight pre[class*='language-']{float:left;min-width:100%;}/*!sc*/
.iyafxb .gatsby-highlight-code-line{background-color:#022a4b;display:block;margin-right:-1em;margin-left:-1em;padding-right:1em;padding-left:0.75em;border-left:0.25em solid #ffdc4e;}/*!sc*/
.iyafxb h1 > code.language-text,.iyafxb h2 > code.language-text,.iyafxb h3 > code.language-text,.iyafxb h4 > code.language-text,.iyafxb h5 > code.language-text,.iyafxb h6 > code.language-text,.iyafxb a > code.language-text,.iyafxb p > code.language-text,.iyafxb li > code.language-text,.iyafxb em > code.language-text,.iyafxb strong > code.language-text{background:#fff9d9;color:#222222cc;padding:0 3px;font-size:0.94em;border-radius:0.3rem;word-wrap:break-word;}/*!sc*/
.iyafxb code{word-wrap:break-word;}/*!sc*/
.iyafxb table{margin-top:1em;border-collapse:collapse;border-radius:0.5em;overflow:hidden;}/*!sc*/
.iyafxb table th,.iyafxb table td{padding:0.5em;background:#f7f7f7;border-bottom:2px solid #ffffff;}/*!sc*/
data-styled.g48[id="Content__ContentBody-sc-p0bolz-0"]{content:"iyafxb,"}/*!sc*/
.gVoql{padding:0 30px 30px;}/*!sc*/
@media only screen and (max-width:500px){.gVoql{padding:0;}}/*!sc*/
data-styled.g49[id="Article__ArticleWrapper-sc-jwdbi9-0"]{content:"gVoql,"}/*!sc*/
.cSangW{position:relative;margin:6rem 0 0;padding:3rem 0 0;border-top:1px solid #ececec;}/*!sc*/
data-styled.g50[id="Article__ArticleFooter-sc-jwdbi9-1"]{content:"cSangW,"}/*!sc*/
.fVTPBL{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;max-width:770px;width:80%;margin:0px auto 30px auto;top:20px;position:relative;}/*!sc*/
@media (max-width:780px){.fVTPBL{width:100%;padding:25px;}}/*!sc*/
data-styled.g51[id="PrevNextPost__PreviewContainer-sc-1r1qyep-0"]{content:"fVTPBL,"}/*!sc*/
.fxMBaz{cursor:pointer;-webkit-flex:1 1 300px;-ms-flex:1 1 300px;flex:1 1 300px;background-color:#ffffff;box-shadow:0 0 0 0,0 6px 12px rgba(0,0,0,0.1);margin:20px 20px;border-radius:5px;}/*!sc*/
.fxMBaz:hover{box-shadow:0 0 0 0,0 6px 12px #B2B3B5;-webkit-transition:all 0.3s ease;transition:all 0.3s ease;-webkit-transform:translate3D(0,-1px,0);-ms-transform:translate3D(0,-1px,0);transform:translate3D(0,-1px,0);}/*!sc*/
@media (min-width:780px){.fxMBaz:first-child{margin-left:0;}.fxMBaz:last-child{margin-right:0;}}/*!sc*/
data-styled.g52[id="PrevNextPost__Preview-sc-1r1qyep-1"]{content:"fxMBaz,"}/*!sc*/
.crPtMJ{width:auto;height:200px;background:#c5d2d9 no-repeat 50%;background-size:cover;border-radius:5px 5px 0 0;}/*!sc*/
data-styled.g53[id="PrevNextPost__PreviewCover-sc-1r1qyep-2"]{content:"crPtMJ,"}/*!sc*/
.biSxKt{padding:20px;}/*!sc*/
.biSxKt header{padding:0 0 10px 0;}/*!sc*/
.biSxKt section{padding-bottom:10px;}/*!sc*/
.biSxKt footer{font-size:0.8em;}/*!sc*/
data-styled.g54[id="PrevNextPost__PreviewContent-sc-1r1qyep-3"]{content:"biSxKt,"}/*!sc*/
.eDlako{text-transform:uppercase;color:#697980;}/*!sc*/
data-styled.g56[id="Commons__ReadingTimeContainer-sc-1aaxjtz-3"]{content:"eDlako,"}/*!sc*/
.igTmPc{color:#697980;}/*!sc*/
data-styled.g57[id="Time__TimeContainer-sc-1u6vd0l-0"]{content:"igTmPc,"}/*!sc*/
</style><title data-react-helmet="true">Snowplow로 데이터 파이프라인 구축하기(feat. 쿠버네티스) | Devnori&#x27;s Tech Blog</title><link data-react-helmet="true" href="https://fonts.googleapis.com/css?family=Lato:400,700&amp;display=swap" rel="stylesheet"/><link data-react-helmet="true" rel="canonical" href="https://Sungchul-P.github.io/snowplow-on-k8s"/><meta data-react-helmet="true" name="description" content="…"/><meta data-react-helmet="true" property="og:url" content="https://Sungchul-P.github.io/snowplow-on-k8s"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="Snowplow로 데이터 파이프라인 구축하기(feat. 쿠버네티스) | Devnori&#x27;s Tech Blog"/><meta data-react-helmet="true" property="og:description" content="…"/><meta data-react-helmet="true" property="og:image" content="https://Sungchul-P.github.io/georgia.png"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content=""/><meta data-react-helmet="true" name="twitter:title" content="Snowplow로 데이터 파이프라인 구축하기(feat. 쿠버네티스) | Devnori&#x27;s Tech Blog"/><meta data-react-helmet="true" name="twitter:description" content="…"/><meta data-react-helmet="true" name="twitter:image" content="https://Sungchul-P.github.io/georgia.png"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'G-F68KCEBSGZ', 'auto', {});
      
      
      
      
      
      }</script><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl+'';f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer', 'G-F68KCEBSGZ');</script><link rel="icon" href="/favicon-32x32.png?v=f44b04687339c42b72dd22b8447a726f" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#222222"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=f44b04687339c42b72dd22b8447a726f"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=f44b04687339c42b72dd22b8447a726f"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=f44b04687339c42b72dd22b8447a726f"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=f44b04687339c42b72dd22b8447a726f"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=f44b04687339c42b72dd22b8447a726f"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=f44b04687339c42b72dd22b8447a726f"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=f44b04687339c42b72dd22b8447a726f"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=f44b04687339c42b72dd22b8447a726f"/><link as="script" rel="preload" href="/webpack-runtime-3ab09ffb6a1ed55510d7.js"/><link as="script" rel="preload" href="/framework-8de36d3fd07627b19105.js"/><link as="script" rel="preload" href="/app-14efb7efc62e45b29dfa.js"/><link as="script" rel="preload" href="/styles-29147cbc04bbc833f6a0.js"/><link as="script" rel="preload" href="/3a2f1ab89072400eb78a258db61265f1964eff8a-06339500b76727572f4d.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-dbffc64738777d602d5e.js"/><link as="fetch" rel="preload" href="/page-data/snowplow-on-k8s/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1182710729.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1956263691.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=G-F68KCEBSGZ" height="0" width="0" style="display: none; visibility: hidden" aria-hidden="true"></iframe></noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><header class="Header__HeaderWrapper-sc-1glvhxp-0 cWgxjN"><nav class="Header__HeaderNav-sc-1glvhxp-1 gMIjKp"><a aria-label="View home page" class="Header__HeaderLink-sc-1glvhxp-3 Header__HeaderLinkTitle-sc-1glvhxp-4 ktAEsK cVdlXH" href="/"><span class="Header__HeaderLinkTitleContent-sc-1glvhxp-5 dkTieV">Devnori&#x27;s Tech Blog</span></a><div class="Header__HeaderLinksContainer-sc-1glvhxp-2 ZwWsM"><a aria-label="View Blog page" class="Header__HeaderLink-sc-1glvhxp-3 ktAEsK" href="/">Blog</a><a aria-label="View About page" class="Header__HeaderLink-sc-1glvhxp-3 ktAEsK" href="/about-me">About</a></div><button aria-label="open menu" class="Header__BurgerButton-sc-1glvhxp-9 dyFkfb"><div class="Header__BurgerContent-sc-1glvhxp-10 ieJuJZ"></div></button></nav></header><div class="layout__SiteContent-sc-nrr2ov-0 iyWqdd"><div style="background-image:url(&quot;/static/7c97972dea5967c954e269382f736784/ee604/georgia.png&quot;)" class="Hero__HeroContainer-sc-1wsaguq-0 PGRvC"><div class="Hero__TitleContainer-sc-1wsaguq-1 cWvcOU"><h1 class="Hero__HeroTitle-sc-1wsaguq-2 izqjLH">Snowplow로 데이터 파이프라인 구축하기(feat. 쿠버네티스)</h1></div></div><main role="main" class="Wrapper-sc-xmiwfw-0 ldnCoM"><article class="Article__ArticleWrapper-sc-jwdbi9-0 gVoql"><section><header class="ContentHeader__Header-sc-1qtxhip-0 dqNEvl"><time class="Time__TimeContainer-sc-1u6vd0l-0 igTmPc">3 August 2022</time><span class="Commons__Bull-sc-1aaxjtz-2 kryMlH"></span><div class="TagList__ListContainer-sc-tgjq80-0 hWQjmQ"><a class="TagList__TagListItemLink-sc-tgjq80-1 fYuXeX" href="/tags/kubernetes">kubernetes</a>, <a class="TagList__TagListItemLink-sc-tgjq80-1 fYuXeX" href="/tags/snowplow">snowplow</a>, <a class="TagList__TagListItemLink-sc-tgjq80-1 fYuXeX" href="/tags/data">data</a>, <a class="TagList__TagListItemLink-sc-tgjq80-1 fYuXeX" href="/tags/pipeline">pipeline</a>, <a class="TagList__TagListItemLink-sc-tgjq80-1 fYuXeX" href="/tags/platform">platform</a></div></header><div class="Content__ContentBody-sc-p0bolz-0 iyafxb"><blockquote><p>본 글에서는 각 컴포넌트의 상세한 로직을 다루지는 않습니다.
소개성 글이라서 과정을 최대한 간결하게 적었기에 다소 불친절하게 느낄 수 있습니다.
직접 실습하고자 하시는 분은 어느정도 데이터 파이프라인 경험과 쿠버네티스를 맛보셨다면 쉽게 경험해 보실 수 있을 것이라 예상됩니다!</p><p>실질적인 구축에 대한 내용은 별도의 레포지터리(<a href="https://github.com/Sungchul-P/snowplow-pipeline">https://github.com/Sungchul-P/snowplow-pipeline</a>) 에서 다루고 있습니다.</p></blockquote><h2 id="snowplow" style="position:relative"><a href="#snowplow" aria-label="snowplow permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Snowplow?</h2><p>Snowplow는 고객 행동 데이터 플랫폼을 서비스하는 회사입니다. AWS와 GCP 기반으로 데이터 플랫폼을 상용서비스하고 있지만, 대부분의 기능을 오픈소스로 사용할 수 있도록 공개하고 있습니다. (TMI; 최근 Snowflake, DataBricks와 협업을 통해 여러 데이터 웨어하우스들과의 연동을 힘쓰고 있는것 같네요.)</p><p>오픈소스에서 본인들의 솔루션을 “행동 데이터를 수집하기 위한 개발자용 엔진”이라고 소개하고 있기에, 내부 구성과 컨셉이 궁금해져서 가이드에 따라 간단한 파이프라인을 구성해보기로 했습니다.</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:29.72972972972973%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABOUlEQVQY0zWQ20rDQABE86/+gn/gN4giFcTHgkJ9adFWLZRaq3irReql2Nq0yW6yt2yy940J4jDM0wwMJyjL0pelK72SliSSpirdFDnTWjlOdZEZa7zVXgmbUV1l+S/vfAABCGEyxwRx4ay3xtUyPvdmtchoKv+qTKqfL4Zi8dCPR53wph0uZzRACIEkAVISpt4GZNJFoyacDcnF8XrSQ3etpH8UV35/oSI3DKlBZ3V9trw4/Z5PScAoxZStpViu+OsAfYxpc2eBI9HY/pw/Z8Mm2N2ane+Fw3aMkYCgMM7XR4gU3NRjXhSJkpCIpw66PYG9g+ixC68am/sWHLfiy/2ofxiH0zxnSmSGpRJDgYCouAQEY4RxlOW5MhUYo533nnONpUqpjNJqomtLnVABSQFxAZhQ2lYgfwFTsEa2IV/jkgAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <picture>
          <source srcSet="/static/1631daa810a53ec193b3df2f1afeb2e7/cbe2e/01-snowplow-pipeline.webp 148w,/static/1631daa810a53ec193b3df2f1afeb2e7/3084c/01-snowplow-pipeline.webp 295w,/static/1631daa810a53ec193b3df2f1afeb2e7/5ca24/01-snowplow-pipeline.webp 590w,/static/1631daa810a53ec193b3df2f1afeb2e7/dad35/01-snowplow-pipeline.webp 885w,/static/1631daa810a53ec193b3df2f1afeb2e7/2baf0/01-snowplow-pipeline.webp 1180w,/static/1631daa810a53ec193b3df2f1afeb2e7/5c6e0/01-snowplow-pipeline.webp 1388w" sizes="(max-width: 590px) 100vw, 590px" type="image/webp"/>
          <source srcSet="/static/1631daa810a53ec193b3df2f1afeb2e7/12f09/01-snowplow-pipeline.png 148w,/static/1631daa810a53ec193b3df2f1afeb2e7/e4a3f/01-snowplow-pipeline.png 295w,/static/1631daa810a53ec193b3df2f1afeb2e7/fcda8/01-snowplow-pipeline.png 590w,/static/1631daa810a53ec193b3df2f1afeb2e7/efc66/01-snowplow-pipeline.png 885w,/static/1631daa810a53ec193b3df2f1afeb2e7/c83ae/01-snowplow-pipeline.png 1180w,/static/1631daa810a53ec193b3df2f1afeb2e7/c1bea/01-snowplow-pipeline.png 1388w" sizes="(max-width: 590px) 100vw, 590px" type="image/png"/>
          <img class="gatsby-resp-image-image" src="/static/1631daa810a53ec193b3df2f1afeb2e7/fcda8/01-snowplow-pipeline.png" alt="01-snowplow-pipeline" title="01-snowplow-pipeline" loading="lazy" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0"/>
        </picture>
    </span></p><h2 id="snowplow-오픈소스-파이프라인" style="position:relative"><a href="#snowplow-%EC%98%A4%ED%94%88%EC%86%8C%EC%8A%A4-%ED%8C%8C%EC%9D%B4%ED%94%84%EB%9D%BC%EC%9D%B8" aria-label="snowplow 오픈소스 파이프라인 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Snowplow 오픈소스 파이프라인</h2><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:45.27027027027027%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0ElEQVQoz12Ry0sbURTG5z9x4aKb0r/AhS2KEtuK2FUtPhc1hZZummUI1S4iRoJYEaELWyUdQ2tJs2hDi31oLBJBNKkwSRkTnck8Mrk3k0zmeed6k9CgfovLxznnx/kOl9L296XlZS2VcjG2LQtjHP2465+JHB6xGLsIYwvmS3/m4V/adR3ckIv/i+IDgWzvbd73QlVVhmEgVAeGZjs6x1/NfShJXP5cquV/sG+7z7YeOjpospdgKRzO3fMIwSCpIeSYpjU1vXjj5uPVN19Jm+zSCr/Zd91cbBQZ6nXYFkXtIGXLcrPeaOT+8cm9k0KBV5SSVterQKwWdqvF4zZDxhBC5KXwJblNtbxlWRzHFYtFYkzLEWVIAHxVlKOXdeHY0WE7UkXiheyRCkoAwHQ6DQHIZNIsy7ajCYLAMFnDMCg5GTzd6JF3ZkwbVSAke2Kzk6uPbh1srTSmEUokEsNDg8+fPQUAEFjX9Sde7/27nljsMyX+9LNrXfwXr2kYiqJUIPgUGHn9oDO5PtfKFo/HPX09E2Oj5ARClstl4vt779A0TdVOt6VfL7XzHVSr13M5p6ZlvtHfl3z8SaoFk8Ch0Pz7SMS27VbyaHQzvBAi/3oB4fTFi4VvRVMAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <picture>
          <source srcSet="/static/853a13fc64cee58e7b6c7e8604907655/cbe2e/02-snowplow-opensource.webp 148w,/static/853a13fc64cee58e7b6c7e8604907655/3084c/02-snowplow-opensource.webp 295w,/static/853a13fc64cee58e7b6c7e8604907655/5ca24/02-snowplow-opensource.webp 590w,/static/853a13fc64cee58e7b6c7e8604907655/dad35/02-snowplow-opensource.webp 885w,/static/853a13fc64cee58e7b6c7e8604907655/2baf0/02-snowplow-opensource.webp 1180w,/static/853a13fc64cee58e7b6c7e8604907655/55e7f/02-snowplow-opensource.webp 1628w" sizes="(max-width: 590px) 100vw, 590px" type="image/webp"/>
          <source srcSet="/static/853a13fc64cee58e7b6c7e8604907655/12f09/02-snowplow-opensource.png 148w,/static/853a13fc64cee58e7b6c7e8604907655/e4a3f/02-snowplow-opensource.png 295w,/static/853a13fc64cee58e7b6c7e8604907655/fcda8/02-snowplow-opensource.png 590w,/static/853a13fc64cee58e7b6c7e8604907655/efc66/02-snowplow-opensource.png 885w,/static/853a13fc64cee58e7b6c7e8604907655/c83ae/02-snowplow-opensource.png 1180w,/static/853a13fc64cee58e7b6c7e8604907655/eee07/02-snowplow-opensource.png 1628w" sizes="(max-width: 590px) 100vw, 590px" type="image/png"/>
          <img class="gatsby-resp-image-image" src="/static/853a13fc64cee58e7b6c7e8604907655/fcda8/02-snowplow-opensource.png" alt="02-snowplow-opensource" title="02-snowplow-opensource" loading="lazy" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0"/>
        </picture>
    </span></p><p>Snowplow의 파이프라인은 “데이터 수집 → 데이터 보강(변환) → 데이터 적재” 라는 큰 흐름은 일반적인 데이터 파이프라인과 크게 다르지 않지만 자체 개발한 스키마 레지스트리 서버(Iglu)와 각 역할별롤 잘 구분되어 관리되고 있는 컴포넌트들을 살펴보고자 했습니다. (대부분 컴포넌트는 스칼라로 개발되어 있습니다.)</p><p>Snowplow는 클라우드 기반 서비스이다 보니, 공식 문서 가이드가 클라우드 환경 위주로 설명되어 있는데 로컬 환경에서 더 간편하게 구현하기 위해 쿠버네티스를 사용했습니다. 역할별로 컴포넌트를 분리하여 관리되고 있으며, 쉽게 구현할 수 있도록 컨테이너 이미지까지 함께 제공하고 있기에 편하게 구성할 수 있었습니다.</p><p>쿠버네티스 및 카프카 클러스터 구성과 배포에 대한 내용은 <a href="https://github.com/Sungchul-P/snowplow-pipeline">별도 레포지터리</a>를 참고해주시기 바랍니다. (쿠버네티스는 kind, 카프카는 Strimzi Operator를 사용해서 구성하였습니다.)</p><h3 id="1-collector" style="position:relative"><a href="#1-collector" aria-label="1 collector permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Collector</h3><p>Collector는 Tracker로부터 HTTP 통신으로 원시 데이터(Raw Data)를 전달 받아서 <strong>Thrift 레코드 포맷으로 직렬화(Serialize)</strong> 한 다음 Sink(여기서는 카프카 사용)로 전송합니다. Thrift으로 직렬화 됐기 때문에 카프카 토픽에서 직접 데이터(메시지)를 확인하면 일부 인코딩이 깨지는 것을 확인할 수 있습니다.</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">d	<span class="token number">127.0</span>.0.1
��<span class="token punctuation">]</span>�u��UTF-8�ssc-2.6.3-kafka,uMozilla/5.0 <span class="token punctuation">(</span>Macintosh<span class="token punctuation">;</span> Intel Mac OS X 10_15_7<span class="token punctuation">)</span> AppleWebKit/537.36 <span class="token punctuation">(</span>KHTML, like Gecko<span class="token punctuation">)</span> Chrome/103.0.0.0 Safari/537.366http://localhost:3000/@<span class="token comment">#/com.snowplowanalytics.snowplow/tp2T#{&quot;schema&quot;:&quot;iglu:com.snowplowanalytics.snowplow/payload_data/jsonschema/1-0-4&quot;,&quot;data&quot;:[{&quot;e&quot;:&quot;pv&quot;,&quot;url&quot;:&quot;http://localhost:3000/&quot;,&quot;page&quot;:&quot;React App&quot;,&quot;refr&quot;:&quot;http://localhost:3000/form&quot;,&quot;eid&quot;:&quot;c71f7c96-597b-4545-be45-ce09649660bd&quot;,&quot;tv&quot;:&quot;js-3.4.0&quot;,&quot;tna&quot;:&quot;ns1&quot;,&quot;p&quot;:&quot;web&quot;,&quot;cookie&quot;:&quot;1&quot;,&quot;cs&quot;:&quot;UTF-8&quot;,&quot;lang&quot;:&quot;ko-KR&quot;,&quot;res&quot;:&quot;2560x1440&quot;,&quot;cd&quot;:&quot;24&quot;,&quot;dtm&quot;:&quot;1659432367557&quot;,&quot;vp&quot;:&quot;306x1304&quot;,&quot;ds&quot;:&quot;306x1304&quot;,&quot;vid&quot;:&quot;4&quot;,&quot;sid&quot;:&quot;b33e46c2-b941-4485-bb99-aa1ed0db449b&quot;,&quot;duid&quot;:&quot;16c0694f-659c-45e7-b1b2-47dbeaa90b40&quot;,&quot;cx&quot;:&quot;eyJzY2hlbWEiOiJpZ2x1OmNvbS5zbm93cGxvd2FuYWx5dGljcy5zbm93cGxvdy9jb250ZXh0cy9qc29uc2NoZW1hLzEtMC0wIiwiZGF0YSI6W3sic2NoZW1hIjoiaWdsdTpjb20uc25vd3Bsb3dhbmFseXRpY3Muc25vd3Bsb3cvd2ViX3BhZ2UvanNvbnNjaGVtYS8xLTAtMCIsImRhdGEiOnsiaWQiOiJkOWFkNGRmOC0xYTViLTQxMDYtYWQzMy01N2JjOTE3OGVmZjMifX1dfQ&quot;,&quot;stm&quot;:&quot;1659432367558&quot;}]}^Timeout-Access: &lt;function1&gt;Host: localhost:9090Connection: keep-aliveMsec-ch-ua: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;103&quot;, &quot;Chromium&quot;;v=&quot;103&quot;sec-ch-ua-mobile: ?0�User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36sec-ch-ua-platform: &quot;macOS&quot;Accept: */*Origin: http://localhost:3000Sec-Fetch-Site: same-siteSec-Fetch-Mode: corsSec-Fetch-Dest: emptyReferer: http://localhost:3000/&quot;Accept-Encoding: gzip, deflate, br7Accept-Language: ko-KR, ko;q=0.9, en-US;q=0.8, en;q=0.7�Cookie: _sp_ses.1fff=*; sp=23741c49-73a2-4bfb-ac0f-e6658947c969; _sp_id.1fff=16c0694f-659c-45e7-b1b2-47dbeaa90b40.1658819065.4.1659432368.1658915156.b33e46c2-b941-4485-bb99-aa1ed0db449bapplication/jsonhapplication/json�	localhost�$23741c49-73a2-4bfb-ac0f-e6658947c969ziAiglu:com.snowplowanalytics.snowplow/CollectorPayload/thrift/1-0-0</span></code></pre></div><p>현재 Snowplow Collector가 지원하는 시스템은 Kafka, NSQ, Amazon Kinesis, Amazon SQS, Google PubSub, stdout 이 있으며, 아래와 같이 간단한 설정을 통해 데이터를 전달할 시스템과 연결할 수 있습니다.</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">collector <span class="token punctuation">{</span>
  interface <span class="token operator">=</span> <span class="token string">&quot;0.0.0.0&quot;</span>
  port <span class="token operator">=</span> <span class="token number">8080</span>

  streams <span class="token punctuation">{</span>
    good <span class="token operator">=</span> <span class="token string">&quot;good&quot;</span>
    bad <span class="token operator">=</span> <span class="token string">&quot;bad&quot;</span>

    sink <span class="token punctuation">{</span>
      brokers <span class="token operator">=</span> <span class="token string">&quot;localhost:9092,another.host:9092&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><blockquote><p>Thrift ?</p><p>Thrift는 RPC 프레임워크 중 하나로 IDL(Interface Definition Language)로 정의한 인터페이스 코드를 각 언어의 보일러 플레이트 코드로 컴파일 할 수 있습니다.
이 보일러 플레이트 코드를 사용하면 서버와 클라이언트간 주고 받는 메시지를 관리하기 편리합니다. (멀티 플랫폼도 지원함)</p><p>좀 더 자세한 내용은 참고자료 링크를 확인해주세요..</p></blockquote><ul><li>Thrift IDL 예시</li></ul><div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java">namespace java <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>snowplowanalytics<span class="token punctuation">.</span>snowplow<span class="token punctuation">.</span></span>CollectorPayload</span><span class="token punctuation">.</span>thrift<span class="token punctuation">.</span>model1

struct <span class="token class-name">CollectorPayload</span> <span class="token punctuation">{</span>
  <span class="token number">31337</span><span class="token operator">:</span> string schema
  <span class="token number">10</span><span class="token operator">:</span> optional string querystring
  <span class="token number">20</span><span class="token operator">:</span> string collector
  <span class="token number">30</span><span class="token operator">:</span> string encoding
  <span class="token number">40</span><span class="token operator">:</span> optional string hostname
  <span class="token number">50</span><span class="token operator">:</span> i64 timestamp
  <span class="token number">60</span><span class="token operator">:</span> string ipAddress
  <span class="token number">70</span><span class="token operator">:</span> optional string userAgent
  <span class="token number">80</span><span class="token operator">:</span> optional string refererUri
  <span class="token number">90</span><span class="token operator">:</span> optional list<span class="token generics"><span class="token punctuation">&lt;</span>string<span class="token punctuation">&gt;</span></span> headers
  <span class="token number">100</span><span class="token operator">:</span> optional string networkUserId
  <span class="token number">110</span><span class="token operator">:</span> string path
  <span class="token number">120</span><span class="token operator">:</span> optional string contentType
  <span class="token number">130</span><span class="token operator">:</span> optional string body
<span class="token punctuation">}</span></code></pre></div><h3 id="2-tracker" style="position:relative"><a href="#2-tracker" aria-label="2 tracker permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Tracker</h3><p>다양한 프로그래밍 언어, 기기, 써드파티 웹훅 등에서 데이터를 수집할 수 있도록 개발되어 있습니다. 이번 구축에서는 <a href="https://github.com/snowplow-incubator/snowplow-javascript-tracker-examples/tree/master/react">JavaScript Tracker 예제</a>를 사용했습니다.</p><p>구글 애널리틱스와 같이 Tracker 스크립트 코드를 삽입하면 행동 데이터를 수집하여 Collector에게 전송합니다.</p><div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Snowplow starts plowing <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;text/javascript&quot;</span><span class="token operator">&gt;</span>
<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">p<span class="token punctuation">,</span>l<span class="token punctuation">,</span>o<span class="token punctuation">,</span>w<span class="token punctuation">,</span>i<span class="token punctuation">,</span>n<span class="token punctuation">,</span>g</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>p<span class="token punctuation">.</span>GlobalSnowplowNamespace<span class="token operator">=</span>p<span class="token punctuation">.</span>GlobalSnowplowNamespace<span class="token operator">||</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span>GlobalSnowplowNamespace<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>q<span class="token operator">=</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>q<span class="token operator">||</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>q<span class="token operator">=</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>q<span class="token operator">||</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>n<span class="token operator">=</span>l<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>g<span class="token operator">=</span>l<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>n<span class="token punctuation">.</span>async<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
n<span class="token punctuation">.</span>src<span class="token operator">=</span>w<span class="token punctuation">;</span>g<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>g<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span>document<span class="token punctuation">,</span><span class="token string">&quot;script&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;{{URL to sp.js}}&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;snowplow&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">snowplow</span><span class="token punctuation">(</span><span class="token string">&#x27;newTracker&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;sp&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;{{collector_url_here}}&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">appId</span><span class="token operator">:</span> <span class="token string">&#x27;my-app-id&#x27;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">snowplow</span><span class="token punctuation">(</span><span class="token string">&#x27;enableActivityTracking&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">minimumVisitLength</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
  <span class="token literal-property property">heartbeatDelay</span><span class="token operator">:</span> <span class="token number">10</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">snowplow</span><span class="token punctuation">(</span><span class="token string">&#x27;trackPageView&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Snowplow stops plowing <span class="token operator">--</span><span class="token operator">&gt;</span></code></pre></div><p>웹 브라우저에서 개발자 도구로 네트워크를 확인하면, 페이지뷰마다 페이로드에 정보를 담아서 Collector에 전송하는 것을 확인할 수 있습니다.</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:79.72972972972973%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB1UlEQVQoz42SCW7bQAxFdY/WtmZfNfsiWbaD3P9S5chpHaANGuCDIKn5o0dK07WtPtaUe6lrqVuIRUjd+rWvt1zX2rZcekw1hAIHFp+iiyFfY+7Qn3rbUl19yKVtt8d77XDbvm47+MthhphyK219liHVXOFNG1gmoay2XhqvlFXaUa640JQJiFwYiAxKaEpDqRxNaRjXAkomJ0IFwhwTgQlEDuVTkF9m8uPnGWEG56DzjH+eQpwA0lintVXKSKml0kobKDvAr7vSFiZ3PgGd+S2pLDsAp8fjDVYRfOi93+/3/br31lJKSyh9u8P+Uuk+lpDGwnzM0AFZFxcXpxCjVIpSGkK43W69rznnxbkLYsIXzBWaCSGcAjYAA+0hjBnBbJoRfep8wafTfDqj8wXNmI5Rl4hinpVF+pAyHwnILKCXGQQG0EgIhy2y2OjbA5c6bOO0m6mYKT+iQLCwz+bXLQRu4dQlHBNaPAiHhKybZ/JZX5n5wHaHAVhAhP997Avz4Oc8NnLdsY8DmMmZsO+ZD2zmEtk2lMrHkqT5pvnAtgH2NICf5Bf8Gvg/2ESw1HBtMDZyfgwP5Meeh44R/m0e/wBTVDtsFqwsVgZLPXJth+CzCQUv+AW76Ze21Ykr+gAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <picture>
          <source srcSet="/static/3fa135ce35ec89b7a48e184380d43875/cbe2e/03-tracker.webp 148w,/static/3fa135ce35ec89b7a48e184380d43875/3084c/03-tracker.webp 295w,/static/3fa135ce35ec89b7a48e184380d43875/5ca24/03-tracker.webp 590w,/static/3fa135ce35ec89b7a48e184380d43875/dad35/03-tracker.webp 885w,/static/3fa135ce35ec89b7a48e184380d43875/2baf0/03-tracker.webp 1180w,/static/3fa135ce35ec89b7a48e184380d43875/2ec00/03-tracker.webp 1972w" sizes="(max-width: 590px) 100vw, 590px" type="image/webp"/>
          <source srcSet="/static/3fa135ce35ec89b7a48e184380d43875/12f09/03-tracker.png 148w,/static/3fa135ce35ec89b7a48e184380d43875/e4a3f/03-tracker.png 295w,/static/3fa135ce35ec89b7a48e184380d43875/fcda8/03-tracker.png 590w,/static/3fa135ce35ec89b7a48e184380d43875/efc66/03-tracker.png 885w,/static/3fa135ce35ec89b7a48e184380d43875/c83ae/03-tracker.png 1180w,/static/3fa135ce35ec89b7a48e184380d43875/ed8a2/03-tracker.png 1972w" sizes="(max-width: 590px) 100vw, 590px" type="image/png"/>
          <img class="gatsby-resp-image-image" src="/static/3fa135ce35ec89b7a48e184380d43875/fcda8/03-tracker.png" alt="03-tracker" title="03-tracker" loading="lazy" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0"/>
        </picture>
    </span></p><h3 id="3-enricher" style="position:relative"><a href="#3-enricher" aria-label="3 enricher permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Enricher</h3><p>Enricher Collector가 Thrift 포맷으로 직렬화해 놓은 데이터(메시지)를 읽어서 IP, UserAgent 에 대한 구문 분석을 통해 데이터를 보강하는 역할을 함과 동시에 스키마 레지스트리로부터 데이터 구조에 대해 유효성을 검증합니다. 또한 Enricher에는 다양한 데이터 보강 및 변환 기능이 내장되어 있으며 설정을 통해 활성화 여부를 결정할 수 있습니다. 각 기능에 대한 파라미터 전달도 스키마 레지스트리를 통해 검증 합니다.</p><div class="gatsby-highlight has-highlighted-lines" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;schema&quot;</span><span class="token operator">:</span> <span class="token string">&quot;iglu:com.snowplowanalytics.snowplow/referer_parser/jsonschema/2-0-0&quot;</span><span class="token punctuation">,</span>

  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;referer_parser&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;vendor&quot;</span><span class="token operator">:</span> <span class="token string">&quot;com.snowplowanalytics.snowplow&quot;</span><span class="token punctuation">,</span>
<span class="gatsby-highlight-code-line">    <span class="token property">&quot;enabled&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>    <span class="token property">&quot;parameters&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;internalDomains&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;database&quot;</span><span class="token operator">:</span> <span class="token string">&quot;referers-latest.json&quot;</span><span class="token punctuation">,</span>
<span class="gatsby-highlight-code-line">      <span class="token property">&quot;uri&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://s3-eu-west-1.amazonaws.com/snowplow-hosted-assets/third-party/referer-parser/&quot;</span></span>    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><p>스키마 레지스트리는 Snowplow 팀에서 자체 구축한 Iglu를 사용하도록 구성되어 있습니다. Iglu는 JSON과 Thrift 스키마 모두 읽을 수 있도록 개발되었으며, 서버를 따로 띄우지 않더라도 <a href="http://iglucentral.com/">Iglu Central</a>이라는 공개 레포지터리를 이용할 수 있습니다. (앱에 Embed 하는 방식도 가능합니다.)</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:58.78378378378378%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUUlEQVQoz41Qy0rDQBSdP7NKC4q4km79gopB0YV051fVWq3iV5SKiyJqbSfzfmYSbyZtDEWqJ4dw53LP3DMH9buPNyfPFwej3s7gdPe2Yq81ON+/63efro/HSWfYa8X+3jDp3Cft0Vl7dHn4cHU0Rl8fZP6e4gWnqdogIxpY14s5m05mL5PZNPJ1+oaccxY+532WbWEWAswIobiQFYVUyJio9AHUQDgCq7rJsq9tFuuiKELIgYhzDvfGc4C/1poxVkTka1R9rZXRTnKjJVgJ0EdCiEofIowxaZpCU0oZ1oA5ay3Y18ozbJafytkszwOCIUpp6TsChtga9Y2hfLADsVGeE0uXxrutYs5/xPVmEAtait1fYr5h2/9nM41o2l6JvYOoODFkoVebYQPGuBLDEGQKR8iMENIUQ5Auiik2uA5Mqd9tQ+BN2xBYaVvHN+OV7W9Pvpw4mF7jqgAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <picture>
          <source srcSet="/static/1a18187f15fa9cfe9d06c2307f1346ed/cbe2e/04-iglu-central.webp 148w,/static/1a18187f15fa9cfe9d06c2307f1346ed/3084c/04-iglu-central.webp 295w,/static/1a18187f15fa9cfe9d06c2307f1346ed/5ca24/04-iglu-central.webp 590w,/static/1a18187f15fa9cfe9d06c2307f1346ed/dad35/04-iglu-central.webp 885w,/static/1a18187f15fa9cfe9d06c2307f1346ed/2baf0/04-iglu-central.webp 1180w,/static/1a18187f15fa9cfe9d06c2307f1346ed/b84eb/04-iglu-central.webp 2000w" sizes="(max-width: 590px) 100vw, 590px" type="image/webp"/>
          <source srcSet="/static/1a18187f15fa9cfe9d06c2307f1346ed/12f09/04-iglu-central.png 148w,/static/1a18187f15fa9cfe9d06c2307f1346ed/e4a3f/04-iglu-central.png 295w,/static/1a18187f15fa9cfe9d06c2307f1346ed/fcda8/04-iglu-central.png 590w,/static/1a18187f15fa9cfe9d06c2307f1346ed/efc66/04-iglu-central.png 885w,/static/1a18187f15fa9cfe9d06c2307f1346ed/c83ae/04-iglu-central.png 1180w,/static/1a18187f15fa9cfe9d06c2307f1346ed/e8950/04-iglu-central.png 2000w" sizes="(max-width: 590px) 100vw, 590px" type="image/png"/>
          <img class="gatsby-resp-image-image" src="/static/1a18187f15fa9cfe9d06c2307f1346ed/fcda8/04-iglu-central.png" alt="04-iglu-central" title="04-iglu-central" loading="lazy" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0"/>
        </picture>
    </span></p><p>Iglu 서버의 스키마 레지스트리를 통해 유효성 검증이 통과된 데이터는 Good Stream으로 보내고, 실패한 데이터는 Bad Stream으로 보내 데이터의 품질을 유지합니다. (카프카에서는 각각 지정한 토픽으로 전송)</p><p>유효성 검증에 실패한 데이터는 Bad Stream에서 아래와 같이 원본 데이터와 원인을 함께 확인할 수 있습니다.</p><div class="gatsby-highlight has-highlighted-lines" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
   <span class="token property">&quot;schema&quot;</span><span class="token operator">:</span> <span class="token string">&quot;iglu:com.snowplowanalytics.snowplow.badrows/schema_violations/jsonschema/2-0-0&quot;</span><span class="token punctuation">,</span>
   <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;processor&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;artifact&quot;</span><span class="token operator">:</span> <span class="token string">&quot;snowplow-stream-enrich&quot;</span><span class="token punctuation">,</span>
         <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3.2.2&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;failure&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-08-02T09:30:10.512839Z&quot;</span><span class="token punctuation">,</span>
         <span class="token property">&quot;messages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
               <span class="token property">&quot;schemaKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;iglu:com.my_company/product_view/jsonschema/1-0-0&quot;</span><span class="token punctuation">,</span>
               <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">                  <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ResolutionError&quot;</span><span class="token punctuation">,</span></span>                  <span class="token property">&quot;lookupHistory&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                     <span class="token punctuation">{</span>
                        <span class="token property">&quot;repository&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Iglu Central&quot;</span><span class="token punctuation">,</span>
                        <span class="token property">&quot;errors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                           <span class="token punctuation">{</span>
                              <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NotFound&quot;</span>
                           <span class="token punctuation">}</span>
                        <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        <span class="token property">&quot;attempts&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                        <span class="token property">&quot;lastAttempt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-08-02T09:30:10.499Z&quot;</span>
                     <span class="token punctuation">}</span><span class="token punctuation">,</span>
                     <span class="token punctuation">{</span>
                        <span class="token property">&quot;repository&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Iglu Client Embedded&quot;</span><span class="token punctuation">,</span>
                        <span class="token property">&quot;errors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                           <span class="token punctuation">{</span>
                              <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NotFound&quot;</span>
                           <span class="token punctuation">}</span>
                        <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        <span class="token property">&quot;attempts&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                        <span class="token property">&quot;lastAttempt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-08-02T09:30:10.284Z&quot;</span>
                     <span class="token punctuation">}</span>
                  <span class="token punctuation">]</span>
               <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;payload&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;enriched&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;app_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;docs-example&quot;</span><span class="token punctuation">,</span>
            ......
            <span class="token property">&quot;true_tstamp&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span>
         <span class="token punctuation">}</span><span class="token punctuation">,</span>
         <span class="token property">&quot;raw&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;vendor&quot;</span><span class="token operator">:</span> <span class="token string">&quot;com.snowplowanalytics.snowplow&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tp2&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;parameters&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
               <span class="token punctuation">{</span>
                  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;e&quot;</span><span class="token punctuation">,</span>
                  <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ue&quot;</span>
               <span class="token punctuation">}</span><span class="token punctuation">,</span>
                 ......
               <span class="token punctuation">{</span>
                  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sid&quot;</span><span class="token punctuation">,</span>
                  <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;87c18fc8-2055-4ec4-8ad6-fff64081c2f3&quot;</span>
               <span class="token punctuation">}</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;contentType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;loaderName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ssc-2.6.3-kafka&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;encoding&quot;</span><span class="token operator">:</span> <span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;hostname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-08-02T09:23:31.702Z&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;ipAddress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;useragent&quot;</span><span class="token operator">:</span> <span class="token string">&quot;curl/7.79.1&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;refererUri&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">&quot;headers&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
               <span class="token string">&quot;Timeout-Access: &lt;function1&gt;&quot;</span><span class="token punctuation">,</span>
               <span class="token string">&quot;Host: localhost:9090&quot;</span><span class="token punctuation">,</span>
               <span class="token string">&quot;User-Agent: curl/7.79.1&quot;</span><span class="token punctuation">,</span>
               <span class="token string">&quot;Accept: */*&quot;</span><span class="token punctuation">,</span>
               <span class="token string">&quot;Cookie: _sp=305902ac-8d59-479c-ad4c-82d4a2e6bb9c&quot;</span><span class="token punctuation">,</span>
               <span class="token string">&quot;application/json&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;userId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3e5d4723-693d-4fc6-887c-d798820e4836&quot;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><h3 id="4-loader" style="position:relative"><a href="#4-loader" aria-label="4 loader permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. Loader</h3><p>Enricher를 거쳐 저장된 데이터는 다양한 데이터 웨어하우스(또는 파일)로 적재할수 있습니다.</p><p>현재 Snowplow에서 지원하는 데이터 웨어하우스는 Big Query, S3, SnowFlake, RedShift, Postgres 등이 있습니다. 단, 현재 Snowplow에서 개발한 Loader들은 데이터 소스를 Kinesis와 PubSub만 지원하기 때문에 Kafka 데이터를 파일로 저장하기 위해서 이번 구축에서는 Kafka Connector를 사용했습니다.</p><p>이 때, 데이터는 TSV 포맷으로 저장되고 각 속성(컬럼)의 정의는 <a href="https://docs.snowplowanalytics.com/docs/understanding-your-pipeline/canonical-event/understanding-the-enriched-tsv-format/">공식문서</a>를 참고해주세요.</p><p>Enricher를 통해 각 이벤트에 IP 기반 지역 정보, 유입 경로, UserAgent 기반 기기 정보 등의 데이터가 보강된 것을 확인할 수 있습니다.</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:54.72972972972974%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAUlEQVQoz31RSRKDMAzj/w9kDVkICfsBOAC3aiJKGaatD8EolqXYkVKqKAqtdThVWQoppTEGuBAiSZK2bbdtm+fZOUdcytIYDTxiEVCeZYi6rolnWdb3/b7vy7I450lGAcS6rotIqKoKJ3LIIkFX8vM8H4bhOA6Qm6ax1qISTHzRNGKnt7KmMhyigsogU9kHZXbH7dM2CQhYYp6m6WXbe09ZDuW0LZW0tUUX3KkQUEaOIkxxHEfYXteVb0F9sG1P2w9ljoB4HMe0fU37afv25nPauGAjrArKP23jh1KEZAjaA443T9N0nzZto/6LbRCYUAHKn2l7/9P2Y8/cPFb1x/YLHrhIXiNJ0xgAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <picture>
          <source srcSet="/static/26ea13452b6aae4badfc2952cb45e3a0/cbe2e/05-loader-filestream.webp 148w,/static/26ea13452b6aae4badfc2952cb45e3a0/3084c/05-loader-filestream.webp 295w,/static/26ea13452b6aae4badfc2952cb45e3a0/5ca24/05-loader-filestream.webp 590w,/static/26ea13452b6aae4badfc2952cb45e3a0/dad35/05-loader-filestream.webp 885w,/static/26ea13452b6aae4badfc2952cb45e3a0/2baf0/05-loader-filestream.webp 1180w,/static/26ea13452b6aae4badfc2952cb45e3a0/b84eb/05-loader-filestream.webp 2000w" sizes="(max-width: 590px) 100vw, 590px" type="image/webp"/>
          <source srcSet="/static/26ea13452b6aae4badfc2952cb45e3a0/12f09/05-loader-filestream.png 148w,/static/26ea13452b6aae4badfc2952cb45e3a0/e4a3f/05-loader-filestream.png 295w,/static/26ea13452b6aae4badfc2952cb45e3a0/fcda8/05-loader-filestream.png 590w,/static/26ea13452b6aae4badfc2952cb45e3a0/efc66/05-loader-filestream.png 885w,/static/26ea13452b6aae4badfc2952cb45e3a0/c83ae/05-loader-filestream.png 1180w,/static/26ea13452b6aae4badfc2952cb45e3a0/e8950/05-loader-filestream.png 2000w" sizes="(max-width: 590px) 100vw, 590px" type="image/png"/>
          <img class="gatsby-resp-image-image" src="/static/26ea13452b6aae4badfc2952cb45e3a0/fcda8/05-loader-filestream.png" alt="05-loader-filestream" title="05-loader-filestream" loading="lazy" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0"/>
        </picture>
    </span></p><h2 id="마무리" style="position:relative"><a href="#%EB%A7%88%EB%AC%B4%EB%A6%AC" aria-label="마무리 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>마무리</h2><p>Snowplow에서는 Loader 이후에, 데이터 모델링과 시각화까지 있으나 이번 글에서는 단순히 데이터 파이프라인 구축에만 집중하기 위해서 다루지 않았습니다.</p><p>나름 한땀 한땀 구축해보며, 느낀 점은 컴포넌트가 역할별로 명확히 나뉘어 있으니 이해하기 편하고 유지보수에도 유리할 것 같다는 점입니다. 거기에 데이터 품질을 보장하기 위한 자체 스키마 레지스트리 서버 구성이 상당히 흥미로웠습니다. (Kafka, Glue 스키마 레지스트리와 사용성이나 장단점을 비교해봐야 겠다는 생각이 들었어요!)</p><p>어떻게 보면 흔한 데이터 파이프라인이겠으나, 특정 플랫폼에서 사용하는 프로세스를 쭉 따라가다 보니 새롭게 알게된 것도 많고 아주 기본적인걸 캐치하지 못해서 헤맸던 부분도 있어서 나름 수확이 많은 과정이었던 것 같네요.</p><p>데이터 파이프라인 고도화나 새로운 기능 개발시에 참고하여 적용해서 사례를 만들어 가봐야 겠습니다.</p><h2 id="참고-자료" style="position:relative"><a href="#%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C" aria-label="참고 자료 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>참고 자료</h2><ul><li><p><a href="https://docs.snowplowanalytics.com/docs/pipeline-components-and-applications/">Snowplow 가이드</a></p></li><li><p><a href="https://ko.wikipedia.org/wiki/%EC%95%84%ED%8C%8C%EC%B9%98_%EC%8A%A4%EB%A6%AC%ED%94%84%ED%8A%B8">Apache Thrift - Wiki</a></p></li><li><p><a href="https://blog.appkr.dev/work-n-play/how-to-use-apache-thrift-in-php-part-1/">RPC - Apache Thrift 입문 1부</a></p></li><li><p><a href="https://blog.appkr.dev/work-n-play/how-to-use-apache-thrift-in-php-part-2/">RPC - Apache Thrift 입문 2부</a></p></li></ul></div></section><footer class="Article__ArticleFooter-sc-jwdbi9-1 cSangW"><div class="Bio__BioWrapper-sc-d7fgaq-0 iUHlwx"><figure class="author-image"><div alt="Sungchul Park" style="background-image:url(&quot;/static/f44b04687339c42b72dd22b8447a726f/66640/icon.png&quot;)" class="img"></div></figure><section><h4>About the author</h4><p class="Commons__Text-sc-1aaxjtz-1 Bio__BioText-sc-d7fgaq-1 cOcOiw bDffwm">
  배움을 멈추지 않고, 언젠가 넓고 깊은 지식을 갖게 되기를 꿈꾸고 있습니다! 🚀 <br>
  또한 누군가에게 선한 영향력을 미칠 수 있는 사람이 되기를 소망합니다 🌟
  </p></section></div></footer></article> </main><main role="main" class="Wrapper-sc-xmiwfw-0 ldnCoM"><div class="comments-wrapper"><div>Loading script...</div><div></div></div></main> <aside class="PrevNextPost__PreviewContainer-sc-1r1qyep-0 fVTPBL"><article class="PrevNextPost__Preview-sc-1r1qyep-1 fxMBaz"><a aria-label="View 쿠버네티스에 Zookeeper 제대로 배포하기 article" href="/zookeeper-on-k8s"><div style="background-image:url(&quot;/static/3421b22668f1163a9a6490d0df595375/zk_logo.png&quot;)" class="PrevNextPost__PreviewCover-sc-1r1qyep-2 crPtMJ"></div><div class="PrevNextPost__PreviewContent-sc-1r1qyep-3 biSxKt"><header><h2>쿠버네티스에 Zookeeper 제대로 배포하기</h2></header><section><p>쿠버네티스 공식 문서 튜토리얼 중 “분산 시스템 코디네이터 Zookeeper…</p></section><footer><span class="Commons__ReadingTimeContainer-sc-1aaxjtz-3 eDlako">6<!-- --> min read</span><span class="Commons__Bull-sc-1aaxjtz-2 kryMlH"></span><div class="TagList__ListContainer-sc-tgjq80-0 hWQjmQ"><span to="/tags/kubernetes" class="TagList__TagListItem-sc-tgjq80-2 iIVHxY">kubernetes</span>, <span to="/tags/statefulset" class="TagList__TagListItem-sc-tgjq80-2 iIVHxY">statefulset</span>, <span to="/tags/liveness" class="TagList__TagListItem-sc-tgjq80-2 iIVHxY">liveness</span>, <span to="/tags/readiness" class="TagList__TagListItem-sc-tgjq80-2 iIVHxY">readiness</span>, <span to="/tags/zookeeper" class="TagList__TagListItem-sc-tgjq80-2 iIVHxY">zookeeper</span></div></footer></div></a></article></aside> <!-- --> </div><footer class="Footer__FooterWrapper-sc-t92llg-0 blEBCc"><nav><div class="footer-col"><h5 class="footer-title">Sungchul Park<!-- --> © <!-- -->2022</h5><p class="footer-item-text">Built with<!-- --> <a class="footer-link" href="https://www.gatsbyjs.org">Gatsby</a>.</p><p class="footer-item-text">Theme using<!-- --> <a class="footer-link" href="https://github.com/maxpou/gatsby-starter-morning-dew">gatsby-starter-morning-dew</a>.</p><p class="footer-item-text">Hosted with<!-- --> <span class="footer-heart" role="img" aria-label="Love">❤</span> <!-- -->by<!-- --> <a class="footer-link" href="https://github.com">GitHub</a>.</p></div><div class="footer-col"><h5 class="footer-title">Explore</h5><span class="footer-item"><a class="footer-link" href="/">Blog</a></span><span class="footer-item"><a class="footer-link" href="/about-me">About</a></span></div><div class="footer-col"><h5 class="footer-title">Follow the author</h5><span class="footer-item"><a class="footer-link" href="https://github.com/Sungchul-P/Sungchul-P.github.io">GitHub</a></span><span class="footer-item"><a class="footer-link" href="https://Sungchul-P.github.io/">Website</a></span></div></nav></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://cdn.panelbear.com/analytics.js?site=AVlbX7MNoAU"></script><script>
          window.panelbear = window.panelbear || function() { (window.panelbear.q = window.panelbear.q || []).push(arguments); };
          panelbear('config', {"site":"AVlbX7MNoAU","spaMode":"history","debug":false});
        </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/snowplow-on-k8s";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-9e490ddcf07d7db5763c.js"],"app":["/app-14efb7efc62e45b29dfa.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-46b4173e1060a5c82475.js"],"component---src-pages-404-js":["/component---src-pages-404-js-a72ee7ffca8b83238a2b.js"],"component---src-templates-blog-list-template-js":["/component---src-templates-blog-list-template-js-54561993b6a7096d46a2.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-dbffc64738777d602d5e.js"],"component---src-templates-page-js":["/component---src-templates-page-js-e29fb330795b9bf9bb62.js"],"component---src-templates-tags-js":["/component---src-templates-tags-js-0ddf0482cd140cfb2415.js"]};/*]]>*/</script><script src="/polyfill-9e490ddcf07d7db5763c.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-dbffc64738777d602d5e.js" async=""></script><script src="/3a2f1ab89072400eb78a258db61265f1964eff8a-06339500b76727572f4d.js" async=""></script><script src="/styles-29147cbc04bbc833f6a0.js" async=""></script><script src="/app-14efb7efc62e45b29dfa.js" async=""></script><script src="/framework-8de36d3fd07627b19105.js" async=""></script><script src="/webpack-runtime-3ab09ffb6a1ed55510d7.js" async=""></script></body></html>